{"ast":null,"code":"import React,{useContext,useState,useEffect}from\"react\";import{ShopContext}from\"../context/ShopContext\";import\"./css/Order.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Order=()=>{const{cartItems,all_products,getTotalCartValue,clearItemFromCart}=useContext(ShopContext);const[orderDetails,setOrderDetails]=useState({name:\"\",phone:\"\",address:\"\",email:\"\",city:\"\",zip:\"\"});const[sdkReady,setSdkReady]=useState(false);// Track if the PayPal SDK is loaded\nconst cartProducts=all_products.filter(product=>cartItems[product.id]>0);const totalPrice=getTotalCartValue();// Load PayPal SDK\nuseEffect(()=>{const addPayPalScript=async()=>{const script=document.createElement(\"script\");script.src=`https://www.paypal.com/sdk/js?client-id=Aaj4iB9K3iSqhCt5suzrRxfiXOMjnZkEitBR-GOBJVIEFuIrLKxZETZILv6MClHS_efn2sI-phA6nQSe&currency=ILS`;script.type=\"text/javascript\";script.async=true;script.onload=()=>setSdkReady(true);document.body.appendChild(script);};if(!window.paypal){addPayPalScript();}else{setSdkReady(true);}},[]);const handleChange=e=>{const{name,value}=e.target;setOrderDetails(prevDetails=>({...prevDetails,[name]:value}));};const handlePlaceOrder=()=>{if(!orderDetails.name||!orderDetails.phone||!orderDetails.address||!orderDetails.email||!orderDetails.city||!orderDetails.zip){alert(\"Please fill out all the required fields!\");return;}console.log(\"Order Placed:\",{orderDetails,cartProducts,totalPrice});};// PayPal Button Configuration\nconst renderPayPalButton=()=>{if(sdkReady){window.paypal.Buttons({createOrder:(data,actions)=>{return actions.order.create({purchase_units:[{amount:{value:totalPrice.toFixed(2),// Total price in ILS\ncurrency_code:\"ILS\"}}]});},onApprove:(data,actions)=>{return actions.order.capture().then(details=>{alert(`Payment successful! Thank you, ${details.payer.name.given_name}.`);clearItemFromCart();// Clear cart\nconsole.log(\"Payment Details:\",details);});},onError:err=>{console.error(\"PayPal Checkout Error:\",err);alert(\"Something went wrong with the payment.\");}}).render(\"#paypal-button-container\");}};useEffect(()=>{if(sdkReady){renderPayPalButton();}},[sdkReady]);return/*#__PURE__*/_jsxs(\"div\",{className:\"order-page\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Complete Your Order\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"contact-form\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Contact Information\"}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Name:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:orderDetails.name,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Phone:\",/*#__PURE__*/_jsx(\"input\",{type:\"tel\",name:\"phone\",value:orderDetails.phone,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Email:\",/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:orderDetails.email,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"City:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"city\",value:orderDetails.city,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Zip Code:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"zip\",value:orderDetails.zip,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Address:\",/*#__PURE__*/_jsx(\"textarea\",{name:\"address\",value:orderDetails.address,onChange:handleChange,required:true})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"order-summary\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Order Summary\"}),cartProducts.map(product=>/*#__PURE__*/_jsxs(\"div\",{className:\"summary-item\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[product.name,\" x \",cartItems[product.id]]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u20AA\",(product.price*cartItems[product.id]).toFixed(2)]})]},product.id)),/*#__PURE__*/_jsxs(\"p\",{className:\"total\",children:[\"Total: \\u20AA\",totalPrice.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"payment-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Payment\"}),sdkReady?/*#__PURE__*/_jsx(\"div\",{id:\"paypal-button-container\"}):/*#__PURE__*/_jsx(\"p\",{children:\"Loading PayPal buttons...\"})]})]});};export default Order;","map":{"version":3,"names":["React","useContext","useState","useEffect","ShopContext","jsx","_jsx","jsxs","_jsxs","Order","cartItems","all_products","getTotalCartValue","clearItemFromCart","orderDetails","setOrderDetails","name","phone","address","email","city","zip","sdkReady","setSdkReady","cartProducts","filter","product","id","totalPrice","addPayPalScript","script","document","createElement","src","type","async","onload","body","appendChild","window","paypal","handleChange","e","value","target","prevDetails","handlePlaceOrder","alert","console","log","renderPayPalButton","Buttons","createOrder","data","actions","order","create","purchase_units","amount","toFixed","currency_code","onApprove","capture","then","details","payer","given_name","onError","err","error","render","className","children","onChange","required","map","price"],"sources":["/Users/nnt/Documents/Projects/Online_PetShop/frontend/src/pages/Order.jsx"],"sourcesContent":["import React, { useContext, useState, useEffect } from \"react\";\nimport { ShopContext } from \"../context/ShopContext\";\nimport \"./css/Order.css\";\n\nconst Order = () => {\n    const { cartItems, all_products, getTotalCartValue, clearItemFromCart } = useContext(ShopContext);\n    const [orderDetails, setOrderDetails] = useState({\n        name: \"\",\n        phone: \"\",\n        address: \"\",\n        email: \"\",\n        city: \"\",\n        zip: \"\",\n    });\n\n    const [sdkReady, setSdkReady] = useState(false); // Track if the PayPal SDK is loaded\n    const cartProducts = all_products.filter((product) => cartItems[product.id] > 0);\n    const totalPrice = getTotalCartValue();\n\n    // Load PayPal SDK\n    useEffect(() => {\n        const addPayPalScript = async () => {\n            const script = document.createElement(\"script\");\n            script.src = `https://www.paypal.com/sdk/js?client-id=Aaj4iB9K3iSqhCt5suzrRxfiXOMjnZkEitBR-GOBJVIEFuIrLKxZETZILv6MClHS_efn2sI-phA6nQSe&currency=ILS`;\n            script.type = \"text/javascript\";\n            script.async = true;\n            script.onload = () => setSdkReady(true);\n            document.body.appendChild(script);\n        };\n\n        if (!window.paypal) {\n            addPayPalScript();\n        } else {\n            setSdkReady(true);\n        }\n    }, []);\n\n    const handleChange = (e) => {\n        const { name, value } = e.target;\n        setOrderDetails((prevDetails) => ({\n            ...prevDetails,\n            [name]: value,\n        }));\n    };\n\n    const handlePlaceOrder = () => {\n        if (\n            !orderDetails.name ||\n            !orderDetails.phone ||\n            !orderDetails.address ||\n            !orderDetails.email ||\n            !orderDetails.city ||\n            !orderDetails.zip\n        ) {\n            alert(\"Please fill out all the required fields!\");\n            return;\n        }\n\n        console.log(\"Order Placed:\", { orderDetails, cartProducts, totalPrice });\n    };\n\n    // PayPal Button Configuration\n    const renderPayPalButton = () => {\n        if (sdkReady) {\n            window.paypal\n                .Buttons({\n                    createOrder: (data, actions) => {\n                        return actions.order.create({\n                            purchase_units: [\n                                {\n                                    amount: {\n                                        value: totalPrice.toFixed(2), // Total price in ILS\n                                        currency_code: \"ILS\",\n                                    },\n                                },\n                            ],\n                        });\n                    },\n                    onApprove: (data, actions) => {\n                        return actions.order.capture().then((details) => {\n                            alert(`Payment successful! Thank you, ${details.payer.name.given_name}.`);\n                            clearItemFromCart(); // Clear cart\n                            console.log(\"Payment Details:\", details);\n                        });\n                    },\n                    onError: (err) => {\n                        console.error(\"PayPal Checkout Error:\", err);\n                        alert(\"Something went wrong with the payment.\");\n                    },\n                })\n                .render(\"#paypal-button-container\");\n        }\n    };\n\n    useEffect(() => {\n        if (sdkReady) {\n            renderPayPalButton();\n        }\n    }, [sdkReady]);\n\n    return (\n        <div className=\"order-page\">\n            <h2>Complete Your Order</h2>\n\n            {/* Contact Information Form */}\n            <div className=\"contact-form\">\n                <h3>Contact Information</h3>\n                <label>\n                    Name:\n                    <input\n                        type=\"text\"\n                        name=\"name\"\n                        value={orderDetails.name}\n                        onChange={handleChange}\n                        required\n                    />\n                </label>\n                <label>\n                    Phone:\n                    <input\n                        type=\"tel\"\n                        name=\"phone\"\n                        value={orderDetails.phone}\n                        onChange={handleChange}\n                        required\n                    />\n                </label>\n                <label>\n                    Email:\n                    <input\n                        type=\"email\"\n                        name=\"email\"\n                        value={orderDetails.email}\n                        onChange={handleChange}\n                        required\n                    />\n                </label>\n                <label>\n                    City:\n                    <input\n                        type=\"text\"\n                        name=\"city\"\n                        value={orderDetails.city}\n                        onChange={handleChange}\n                        required\n                    />\n                </label>\n                <label>\n                    Zip Code:\n                    <input\n                        type=\"text\"\n                        name=\"zip\"\n                        value={orderDetails.zip}\n                        onChange={handleChange}\n                        required\n                    />\n                </label>\n                <label>\n                    Address:\n                    <textarea\n                        name=\"address\"\n                        value={orderDetails.address}\n                        onChange={handleChange}\n                        required\n                    />\n                </label>\n            </div>\n\n            {/* Order Summary */}\n            <div className=\"order-summary\">\n                <h3>Order Summary</h3>\n                {cartProducts.map((product) => (\n                    <div key={product.id} className=\"summary-item\">\n                        <p>\n                            {product.name} x {cartItems[product.id]}\n                        </p>\n                        <p>₪{(product.price * cartItems[product.id]).toFixed(2)}</p>\n                    </div>\n                ))}\n                <p className=\"total\">Total: ₪{totalPrice.toFixed(2)}</p>\n            </div>\n\n            {/* Payment Section */}\n            <div className=\"payment-section\">\n                <h3>Payment</h3>\n                {sdkReady ? (\n                    <div id=\"paypal-button-container\"></div>\n                ) : (\n                    <p>Loading PayPal buttons...</p>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default Order;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}